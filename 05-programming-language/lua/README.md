# LUA 源码

> lua-5.4.3

> lua源码学习, windows 平台编译

## 资源

> [官网](http://www.lua.org/)
>
>   - [lua-5.4.3.tar.gz @ 2021-03-15, 350K](http://www.lua.org/ftp/lua-5.4.3.tar.gz)
>
>   - [文档](http://www.lua.org/docs.html) [](http://www.lua.org/manual/5.4/)

> [Lua 教程](https://www.runoob.com/lua/lua-tutorial.html)


> [Lua源码分析](https://blog.csdn.net/initphp/article/details/82703846)

> [Lua源码分析 -- 虚拟机以及指令解释](https://blog.csdn.net/jinxinliu1/article/details/80484675)

> [如何学习 Lua VM 的源码？](https://www.zhihu.com/question/20617406)

### 教学视频

> [Lua语言教程](https://www.bilibili.com/video/BV1r64y197cW)


## 简介

Lua 是一种 免费开源的，强大高效、轻量级、可嵌入的脚本语言，动态类型语言。它支持过程编程、面向对象编程、函数式编程、数据驱动编程和数据描述。

是巴西里约热内卢天主教大学（Pontifical Catholic University of Rio de Janeiro）里的一个由Roberto Ierusalimschy、Waldemar Celes 和 Luiz Henrique de Figueiredo三人所组成的研究小组于1993年开发的。 其设计目的是为了通过灵活嵌入应用程序中从而为应用程序提供灵活的扩展和定制功能。

![LUA语言架构图](https://img-blog.csdnimg.cn/20200409172211534.jpg)

Lua由标准C编写而成，几乎在所有操作系统和平台上都可以编译，运行。Lua并没有提供强大的库，这是由它的定位决定的。所以Lua不适合作为开发独立应用程序的语言。Lua 有一个同时进行的JIT项目，提供在特定平台上的即时编译功能。

Lua是解释型语言，通过对Lua的语言进行语法解析，然后生成二进制字节码，然后转由C语言进行执行操作。编译型语言，则会进行编译后生成机器码，直接由机器进行执行即可，执行效率会比较高。

其动态类型，通过使用基于寄存器的虚拟机解释字节码来运行，并具有自动内存管理和分代垃圾收集功能，使其成为配置、脚本编写和快速原型设计的理想选择。

Lua 旨在用作任何需要的程序的强大、轻量级、可嵌入的脚本语言，以及功能强大但轻量级且高效的独立语言。

作为一种扩展语言，Lua 没有“主”程序的概念：它嵌入在主机客户端中工作，称为嵌入程序或简称为主机。宿主程序可以调用函数来执行一段Lua代码，可以读写Lua变量，可以注册C函数供Lua代码调用。通过使用 C 函数，Lua 可以被扩充以应对广泛的不同领域，从而创建共享句法框架的定制编程语言。

Lua 是一种区分大小写的语言

> 基本类型

有八种基本类型： nil、boolean、number、 string、function、userdata、thread和table。nil类型只有一个值nil，其主要属性是与任何其他值不同；它通常代表没有有用的价值。

表是 Lua 中唯一的数据结构机制；它们可以用来表示普通的数组、列表、符号表、集合、记录、图、树等。为了表示记录，Lua 使用字段名作为索引。该语言通过为 提供a.name语法糖来支持这种表示a["name"]

与索引一样，表字段的值可以是任何类型。特别是，由于函数是一等值，表字段可以包含函数。因此表也可以携带方法，表的索引遵循语言中原始相等的定义。

> GC

Lua 执行自动内存管理。这意味着您不必担心为新对象分配内存或在不再需要对象时释放它。Lua 通过运行垃圾收集器来收集所有死对象来自动管理内存。Lua 使用的所有内存都受到自动管理：字符串、表、用户数据、函数、线程​​、内部结构等。

> 协程

Lua 支持协程，也称为协作多线程。Lua 中的协程代表一个独立的执行线程。然而，与多线程系统中的线程不同，协程仅通过显式调用 yield 函数来暂停其执行。

> 语言特性

变量是存储值的地方。Lua 中共有三种变量：全局变量、局部变量和表字段。

> LUA C API

宿主程序可用于与 Lua 通信的 C 函数集。所有 API 函数和相关类型和常量都在头文件中声明lua.h。

Lua 库是完全可重入的：它没有全局变量。它将所有需要的信息保存在一个动态结构中，称为Lua 状态。

每个 Lua 状态都有一个或多个线程，它们对应于独立的、协作的执行线。

Lua 使用一个虚拟堆栈来向 C 和从 C 传递值。这个堆栈中的每个元素代表一个 Lua 值（nil、数字、字符串等）。API 中的函数可以通过它们接收到的 Lua 状态参数访问这个堆栈。


